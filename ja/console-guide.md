## Storage > NAS > コンソール使用ガイド

### ストレージの作成

新しいストレージを作成します。作成されたストレージはNFS(network file system、ネットワークファイルシステム)プロトコルを利用してインスタンスからアクセスできます。

| 項目 | 説明 |
| -- | -- |
| 名前 | 作成されるストレージの名前です。ストレージ名を利用してNFSアクセスパスを作成します。名前は100文字以内の英字と数字、一部記号('-', '_')のみ入力できます。 |
| 説明 | ストレージの説明です。 |
| サイズ | 作成されるストレージのサイズです。最小300GBから最大10,000GBまで入力できます。 |
| VPC | ストレージにアクセスするVPC(virtual private cloud、仮想プライベートクラウド)です。 |
| サブネット | ストレージにアクセスするサブネットです。選択されたVPCのサブネットのみ選択できます。 |
| アクセス制御リスト(ACL) | 読み取り、書き込み権限を許可するIPまたはIP帯域リストです。 |
| スナップショット自動作成 | 毎日1回指定された時間に自動的に作成します。最大保存数に達すると、作成されたスナップショットのうち、最も古いスナップショットが自動的に削除されます。  |
| スナップショット保存容量 | スナップショット容量の合計が設定したサイズを超える場合、すべてのスナップショットのうち最も古いスナップショットが削除されます。 |
| 暗号化 | ストレージ暗号化を使用するかどうかを選択します。暗号化キーストア設定が 先に行われなければなりません。 |

> [参考]
> 2024年2月現在、プロジェクトごとに使用可能なサブネットは合計3つに制限されます。サブネット数の限度を増やす場合はサポートにお問い合わせください。

#### 暗号化キーストア設定

NAS暗号化ストレージは、暗号化に使用する対称鍵をNHN Cloud Secure Key Managerサービスのキーストアに保存します。したがって、暗号化ストレージを作成するためには、事前にSecure Key Managerサービスで[キーストアを作成](https://docs.nhncloud.com/ja/Security/Secure%20Key%20Manager/ja/getting-started/#_1)する必要があります。 [キーストアのIDを確認](https://docs.nhncloud.com/ja/Security/Secure%20Key%20Manager/ja/getting-started/#_2)して暗号化キーストア設定に入力します。

暗号化ストレージを作成すると、設定したキーストアに対称鍵が保存されます。NASサービスによってキーストアに保存された対称鍵は暗号化ストレージの使用中は削除できません。暗号化ストレージを削除すると、対称鍵も一緒に削除されます。

キーストアIDを変更すると、その後作成する暗号化ストレージの対称鍵が変更されたキーストアに保存されます。既存キーストアに保存された対称鍵は維持されます。

> [参考]
> Secure Key Managerサービス料金ポリシーに基づいてキーストア使用料金が請求されます。利用料金の詳細については、 [Secure Key Manager料金案内](https://www.nhncloud.com/kr/service/security/secure-key-manager#price)を参照してください。
>
> NAS暗号化ストレージは、XTS-AES-256アルゴリズムで異なる2つの対称鍵を使用してデータを暗号化します。 したがって、暗号化ストレージごとに2つの対称鍵をキーストレージに保存します。

### ストレージサイズ変更

NASストレージのサイズを変更します。ストレージの使用中にも拡張および縮小が可能です。

### アクセス制御リスト設定の変更

ストレージのアクセス制御リスト(ACL)設定を変更します。

### スナップショット設定の変更

スナップショット自動作成およびスナップショット保存容量の設定を変更します。

### ストレージ削除

NASストレージを削除します。

> [注意]
> 接続されたインスタンスからマウント解除後、削除することを推奨します。マウント状態でストレージを削除すると、ユーザーシステムに問題が発生する可能性があります。
>
> ストレージを削除すると、スナップショットを含むすべてのデータが削除されます。削除後にはデータを復元できません。

### スナップショット作成

NASストレージのスナップショットをすぐに作成します。

### ストレージ復元

ストレージをスナップショットが作成された時点に復元します。スナップショットを復元するにはサポートにお問い合わせください。

> [注意]
> 復元すると、復元時点以降に作成されたスナップショットは自動的に削除されます。

### スナップショット削除

指定されたスナップショットを削除します。一度削除されたスナップショットは復元できません。

### モニタリング

NASストレージの複数の指標をグラフで確認します。確認したいストレージを選択した後、 **モニタリング**タブを選択します。

基本的な照会期間は最後の1時間で、照会期間フィルタで特定の期間を照会できます。モニタリング指標の説明は以下の表で確認できます。

| 指標 | 単位 | 説明 |
| --- | --- | --- |
| ストレージ容量 | byte | ストレージの総容量と使用中の容量を表示します。 |
| ストレージ使用率 | % | ストレージの総容量に対する使用中の容量をパーセンテージで表示します。 |
| IOPS | OPS | ストレージの毎秒の演算数を表示します。 |
| Latency | usec | ストレージの遅延時間を表示します。 |
| スナップショット数 | - | ストレージのスナップショット数を表示します。 |
| スナップショット容量 | byte | ストレージがスナップショットに使用している容量を表示します。 |
| Inode | - | ストレージのinode数を表示します。 |
| ストレージ状態 | - | ストレージの状態を表示します。 |
| クライアント接続数 | - | ストレージに接続されたクライアント数を表示します。 |


### ストレージ接続

作成されたストレージの接続情報を利用してインスタンスにマウントできます。ただし、マウントするインスタンスはストレージと同じサブネットに接続されている必要があります。

#### nfsパッケージのインストール

* Debian, Ubuntu: nfs-common, rpcbind
  ```
  sudo apt-get install nfs-common rpcbind
  ```
* CentOS: nfs-utils, rpcbind
  ```
  sudo yum install nfs-utils rpcbind
  ```

#### rpcbindサービス実行

```
sudo service rpcbind start
```

#### NASストレージマウント

```
sudo mount -t nfs {nas source} {mount point}
```

* nas source: NASストレージ情報
 例) 192.168.0.241:/data
* mount point: NASストレージをマウントするディレクトリ
 例) /mnt
